$schema: http://json-schema.org/draft-07/schema#
id: https://kamu.dev/schemas/dataset_root_desc/v0.1
type: object
additionalProperties: false
required:
- id
- url
- format
- mergeStrategy
properties:
  id:
    type: string
  url:
    type: string
  compression:
    type: string
    enum:
    - zip
  subPath:
    type: string
    description: Path to a data file within an archive
  subPathRegex:
    type: string
    description: Regex for finding desired data file within an archive
  format:
    type: string
    enum:
    - csv
    description: A raw data format (as supported by Spark's read function)
  readerOptions:
    type: object
    additionalProperties: true
    default:
      mode: FAILFAST
    description: A map of options that will be passed into the reader. You can use it to control things like separators in the CSV file etc.
  schema:
    type: array
    items:
      type: string
    description: A DDL-formatted schema that can be used to cast values into more appropriate data types
  preprocess:
    type: object
    additionalProperties: false
    properties:
      view:
        type: string
        description: The name of the view the result of the query will be assigned to
      query:
        type: string
        description: An SQL query
    description: Pre-processing steps to shape the data
  mergeStrategy:
    type: string
    enum:
    - Append
    - Snapshot
    - Ledger
    description: One of the supported merge strategies
  coalesce:
    type: integer
    minimum: 0
    default: 1
    description: Collapse partitions of the result to specified number. If zero - the step will be skipped.
